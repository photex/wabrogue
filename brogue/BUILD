# Brogue

filegroup(
    name="fonts",
    srcs=glob(["fonts/font-*.png"]),
)

cc_binary(
    name="wabrogue.html",
    srcs=[
        "src/Architect.c",
	"src/Combat.c",
	"src/Dijkstra.c",
	"src/Globals.c",
	"src/IO.c",
	"src/Buttons.c",
	"src/MainMenu.c",
	"src/Items.c",
	"src/Light.c",
	"src/Monsters.c",
	"src/Movement.c",
	"src/RogueMain.c",
	"src/Random.c",
	"src/Recordings.c",
	"src/platform/platformdependent.c",
	"src/platform/tcod-platform.c",
	"src/platform/wasm_main.c",
        "//vendor/libtcod:sources",
        "//vendor/SDL2:sources",
    ],
    hdrs=[
        "src/platform/PlatformDefines.h",
        "src/platform/platform.h",
        "src/IncludeGlobals.h",
        "src/Rogue.h",
        "//vendor/libtcod:headers",
        "//vendor/SDL2:headers",
    ],
    defines=[
        "__EMSCRIPTEN__",
        "BROGUE_TCOD",
        "LIBTCOD_EXPORTS",
        "NO_OPENGL",
        "TCOD_EMSCRIPTEN",
        "TCOD_CONSOLE_SUPPORT",
        "TCOD_IMAGE_SUPPORT",
        "TCOD_OSUTIL_SUPPORT",
        "USING_GENERATED_CONFIG_H",
    ]
    copts=[
        "-idirafter",
        "$(location //vendor/SDL2:khronos)",
    ],
    linkopts=[
        "--preload-file",
        "keymap",
        "--preload-file",
        "fonts",
        "--preload-file",
        "icon.bmp",
    ],
    data=[
        "icon.bmp",
        "keymap",
        ":fonts",
    ],
)
